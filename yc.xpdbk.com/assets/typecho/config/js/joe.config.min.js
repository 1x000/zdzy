document.addEventListener("DOMContentLoaded",function(){Joe.domain=window.location.host;Joe.service_domain='//auth.bri6.cn/server/joe/';var e=document.querySelectorAll(".joe_config__aside .item"),t=document.querySelector(".joe_config__notice"),o=document.querySelector(".joe_config > form"),n=document.querySelectorAll(".joe_content");if(e.forEach(function(s){s.addEventListener("click",function(){e.forEach(function(e){e.classList.remove("active")}),s.classList.add("active");var a=s.getAttribute("data-current");sessionStorage.setItem("joe_config_current",a),"joe_notice"===a?(t.style.display="block",o.style.display="none"):(t.style.display="none",o.style.display="block"),n.forEach(function(e){e.style.display="none",e.classList.contains(a)&&(e.style.display="block")})})}),sessionStorage.getItem("joe_config_current")){var s=sessionStorage.getItem("joe_config_current");"joe_notice"===s?(t.style.display="block",o.style.display="none"):(o.style.display="block",t.style.display="none"),e.forEach(function(e){e.getAttribute("data-current")===s&&e.classList.add("active")}),n.forEach(function(e){e.classList.contains(s)&&(e.style.display="block")})}else e[0].classList.add("active"),t.style.display="block",o.style.display="none";var a=new XMLHttpRequest;function i(e="passive"){$.ajax({type:"post",url:`${Joe.service_domain}update`,data:{title:Joe.title,version:Joe.version,domain:Joe.domain,logo:Joe.logo,favicon:Joe.Favicon},dataType:"json",beforeSend:()=>{"active"==e&&layer.load(1,{shade:[.3,"#fff"]})},success:t=>{if(layer.closeAll(),t.update){var o=JSON.stringify(t.btn);o=JSON.parse(o),layer.confirm(t.msg,{btn:o},function(){!function(e,t={}){var o='<form action="'+e+'"  target="_blank"  id="windowOpen" style="display:none">';if(t)for(var n in t)o+='<input name="'+n+'" value="'+t[n]+'"/>';o+="</form>",$("body").append(o),$("#windowOpen").submit(),$("#windowOpen").remove()}(t.download,t.param)})}else"active"==e&&layer.msg(t.msg)},error:()=>{layer.closeAll(),layer.msg("请求错误，请检查您的网络")}})}a.onreadystatechange=function(){if(4===a.readyState)if(200<=a.status&&300>a.status||304===a.status){var e=JSON.parse(a.responseText);t.innerHTML=e.success?'<p class="title">最新版本：'+e.title+"</p>"+e.content:"请求失败！"}else t.innerHTML="请求失败！"},a.open("get",`${Joe.service_domain}message`,!0),a.send(null),i(),$("#update").click(()=>{i("active")})})